{{!< default}}

{{!-- The tag above means: insert everything in this file
into the {body} of the default.hbs template --}}

<header class="site-header-single outer">
	<div class="inner">
		<a href="/">
			<h1 class="site-title">
				{{@blog.title}}
			</h1>
		</a>
	</div>
</header>

{{!-- Everything inside the #post tags pulls data from the post --}}
{{#post}}

<main id="site-main" class="site-main site-main-single outer" role="main">
	<div class="inner">

		<article class="post-full {{post_class}} {{#unless feature_image}}no-image{{/unless}}">

			<header class="post-full-header">
				<section class="post-full-meta">
					<time class="post-full-meta-date" datetime="{{date format="YYYY-MM-DD"}}">{{date format="D MMMM YYYY"}}</time>
				</section>
				<h1 class="post-full-title">{{title}}</h1>
			</header>

{{!-- 			{{#if feature_image}}
			<figure class="post-full-image" style="background-image: url({{feature_image}})">
			</figure>
			{{/if}} --}}

			<section class="post-full-content">
				{{content}}
			</section>

			<footer class="post-full-footer">
				{{!-- Everything inside the #author tags pulls data from the author --}}
				{{#author}}

				<section class="author-card">
					{{#if profile_image}}
						<img class="author-profile-image" src="{{profile_image}}" alt="{{name}}" />
					{{/if}}
					<section class="author-card-content">
						<h4 class="author-card-name"><a href="{{url}}">{{name}}</a></h4>
						{{#if bio}}
							<p>{{bio}}</p>
						{{else}}
							<p>Read <a href="{{url}}">more posts</a> by this author.</p>
						{{/if}}
					</section>
					<section class="author-card-contact">
						<ul>
							<li>Email: <pre>machaerus (at) pm.me</pre></li>
							{{!-- <li>Github: <a href="https://github.com/machaerus"><pre>machaerus</pre></a></li> --}}
							<li>Keybase: <pre>machaerus</pre></li>
							<li>Last.fm: <pre><a href="https://www.last.fm/user/Fikander23">Fikander23</a></pre></li>
						</ul>
					</section>
				</section>
{{!-- 				<div class="post-full-footer-right">
					<a class="author-card-button" href="{{url}}">Read More</a>
				</div> --}}

				{{/author}}
			</footer>

			{{#is "post, page"}}
				<script data-isso="https://wiruje-astrolabium.pl/isso/"
						data-isso-avatar="false"
						data-isso-lang="pl"
						src="https://wiruje-astrolabium.pl/isso/js/embed.min.js">
				</script>
				<section id="isso-thread"></section>
			{{/is}}

			{{!--

			If you use Disqus comments, just uncomment this block.
			The only thing you need to change is "test-apkdzgmqhj" - which
			should be replaced with your own Disqus site-id.

			<section class="post-full-comments">
				<div id="disqus_thread"></div>
				<script>
					var disqus_config = function () {
						this.page.url = '{{url absolute="true"}}';
						this.page.identifier = 'ghost-{{comment_id}}';
					};
					(function() {
						var d = document, s = d.createElement('script');
						s.src = 'https://test-apkdzgmqhj.disqus.com/embed.js';
						s.setAttribute('data-timestamp', +new Date());
						(d.head || d.body).appendChild(s);
					})();
				</script>
			</section>
			--}}

		</article>

	</div>
</main>

{{!-- Links to Previous/Next posts --}}

<aside class="read-next outer">
	<div class="inner">
		<div class="read-next-feed">
			
			<div class="next">
			{{#next_post}}
				{{> "post-card"}}
			{{/next_post}}
			</div>

			<div class="prev">
			{{#prev_post}}
				{{> "post-card"}}
			{{/prev_post}}
			</prev>

		</div>
	</div>
</aside>
 

{{/post}}

{{!-- The #contentFor helper here will send everything inside it up to the matching #block helper found in default.hbs --}}
{{#contentFor "scripts"}}
<script>

// NOTE: Scroll performance is poor in Safari
// - this appears to be due to the events firing much more slowly in Safari.
//   Dropping the scroll event and using only a raf loop results in smoother
//   scrolling but continuous processing even when not scrolling
$(document).ready(function () {
	// Start fitVids
	var $postContent = $(".post-full-content");
	$postContent.fitVids();
	// End fitVids

	var progressBar = document.querySelector('progress');
	var header = document.querySelector('.floating-header');
	var title = document.querySelector('.post-full-title');

	var lastScrollY = window.scrollY;
	var lastWindowHeight = window.innerHeight;
	var lastDocumentHeight = $(document).height();
	var ticking = false;

	function onScroll() {
		lastScrollY = window.scrollY;
		requestTick();
	}

	function onResize() {
		lastWindowHeight = window.innerHeight;
		lastDocumentHeight = $(document).height();
		requestTick();
	}

	function requestTick() {
		if (!ticking) {
			requestAnimationFrame(update);
		}
		ticking = true;
	}

	function update() {
		var trigger = title.getBoundingClientRect().top + window.scrollY;
		var triggerOffset = title.offsetHeight + 35;
		var progressMax = lastDocumentHeight - lastWindowHeight;

		// show/hide floating header
		if (lastScrollY >= trigger + triggerOffset) {
			header.classList.add('floating-active');
		} else {
			header.classList.remove('floating-active');
		}

		progressBar.setAttribute('max', progressMax);
		progressBar.setAttribute('value', lastScrollY);

		ticking = false;
	}

	window.addEventListener('scroll', onScroll, {passive: true});
	window.addEventListener('resize', onResize, false);

	update();

	// $("#isso-thread input[name='author']").attr("placeholder", "ImiÄ™");
});
</script>
{{/contentFor}}
